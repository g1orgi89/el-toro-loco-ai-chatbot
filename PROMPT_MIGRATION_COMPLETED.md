# üçÑ –ú–∏–≥—Ä–∞—Ü–∏—è –ø—Ä–æ–º–ø—Ç–æ–≤ –ó–ê–í–ï–†–®–ï–ù–ê

## –°—Ç–∞—Ç—É—Å: ‚úÖ COMPLETED

–ú–∏–≥—Ä–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã –ø—Ä–æ–º–ø—Ç–æ–≤ —Å —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã –Ω–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –∏ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∞.

## –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ:

### ‚úÖ –≠–¢–ê–ü 1: –°–û–ó–î–ê–ù–ò–ï PROMPT SERVICE
- [x] –°–æ–∑–¥–∞–Ω `PromptService` –≤ `server/services/promptService.js`
- [x] –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–º–ø—Ç–æ–≤ –≤ –ø–∞–º—è—Ç–∏ (5 –º–∏–Ω—É—Ç)
- [x] –î–æ–±–∞–≤–ª–µ–Ω–∞ fallback —Å–∏—Å—Ç–µ–º–∞ –Ω–∞ —Å–ª—É—á–∞–π –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –ë–î
- [x] –°–æ–∑–¥–∞–Ω–∞ –º–æ–¥–µ–ª—å `Prompt` –≤ `server/models/prompt.js`

### ‚úÖ –≠–¢–ê–ü 2: –ü–ï–†–ï–ü–ò–°–ö–ê CLAUDE SERVICE
- [x] –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω `PromptService` –≤ `ClaudeService`
- [x] –ó–∞–º–µ–Ω–µ–Ω—ã –∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã –Ω–∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ:
  - `_getSystemPrompt(language)` ‚Üí async —á–µ—Ä–µ–∑ PromptService
  - `_getRagPrompt(language)` ‚Üí async —á–µ—Ä–µ–∑ PromptService
- [x] –û–±–Ω–æ–≤–ª–µ–Ω—ã –≤—Å–µ –º–µ—Ç–æ–¥—ã –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å async –ø—Ä–æ–º–ø—Ç–∞–º–∏

### ‚úÖ –≠–¢–ê–ü 3: –û–ß–ò–°–¢–ö–ê –§–ê–ô–õ–û–í–´–• –ü–†–û–ú–ü–¢–û–í
- [x] –û—á–∏—â–µ–Ω `server/config/prompts.js` –æ—Ç —Å–ª–æ–∂–Ω—ã—Ö –ø—Ä–æ–º–ø—Ç–æ–≤
- [x] –°–æ–∑–¥–∞–Ω `server/config/fallbackPrompts.js` —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º–∏ –ø—Ä–æ–º–ø—Ç–∞–º–∏
- [x] –î–æ–±–∞–≤–ª–µ–Ω—ã deprecation warnings –¥–ª—è —Å—Ç–∞—Ä—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
- [x] –°–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –æ–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

### ‚úÖ –≠–¢–ê–ü 4: –ü–û–î–ì–û–¢–û–í–ö–ê –ü–†–û–ú–ü–¢–û–í –î–õ–Ø –ê–î–ú–ò–ù–ö–ò
- [x] –°–æ–∑–¥–∞–Ω `scripts/defaultPrompts.json` —Å —É–ª—É—á—à–µ–Ω–Ω—ã–º–∏ –ø—Ä–æ–º–ø—Ç–∞–º–∏
- [x] –°–æ–∑–¥–∞–Ω —Å–∫—Ä–∏–ø—Ç `scripts/loadDefaultPrompts.js` –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–æ–º–ø—Ç–æ–≤
- [x] –ù–∞—Å—Ç—Ä–æ–µ–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–º–ø—Ç–æ–≤ –¥–ª—è –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏:

```
üçÑ –ù–û–í–ê–Ø –°–ò–°–¢–ï–ú–ê:
üì± –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å ‚Üí üóÑÔ∏è MongoDB ‚Üí ‚ö° PromptService (–∫–µ—à) ‚Üí ü§ñ Claude
                              ‚Üì
                         üõ°Ô∏è Fallback –ø—Ä–æ–º–ø—Ç—ã (–µ—Å–ª–∏ –ë–î –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞)

üóëÔ∏è –°–¢–ê–†–ê–Ø –°–ò–°–¢–ï–ú–ê (—É–¥–∞–ª–µ–Ω–∞):
üìÑ –§–∞–π–ª—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ ‚Üí ü§ñ Claude
```

## –¢–∏–ø—ã –ø—Ä–æ–º–ø—Ç–æ–≤:

1. **basic** - –æ—Å–Ω–æ–≤–Ω–æ–π —Å–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç (EN, ES, RU)
2. **rag** - –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–∞–∑–æ–π –∑–Ω–∞–Ω–∏–π (EN, ES, RU)  
3. **ticket_detection** - –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∏–∫–µ—Ç–æ–≤
4. **categorization** - –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏—è —Ç–∏–∫–µ—Ç–æ–≤
5. **subject** - —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ —Ç–∏–∫–µ—Ç–æ–≤

## –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ –Ω–æ–≤–æ–º –∫–æ–¥–µ:

```javascript
// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û (–Ω–æ–≤—ã–π –∫–æ–¥):
const promptService = require('../services/promptService');
const prompt = await promptService.getActivePrompt('basic', 'en');

// ‚ùå DEPRECATED (—Å—Ç–∞—Ä—ã–π –∫–æ–¥):
const { getSystemPrompt } = require('../config/prompts');
const prompt = getSystemPrompt('basic', 'en');
```

## –§–∞–π–ª—ã, –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ –∏–∑–º–µ–Ω–µ–Ω—ã:

### –û—Å–Ω–æ–≤–Ω—ã–µ:
- `server/services/promptService.js` - **–Ω–æ–≤—ã–π —Å–µ—Ä–≤–∏—Å**
- `server/services/claude.js` - **–æ–±–Ω–æ–≤–ª–µ–Ω –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è PromptService**
- `server/config/prompts.js` - **–æ—á–∏—â–µ–Ω, –æ—Å—Ç–∞–≤–ª–µ–Ω—ã —Ç–æ–ª—å–∫–æ fallback**
- `server/config/fallbackPrompts.js` - **–Ω–æ–≤—ã–π —Ñ–∞–π–ª —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º–∏ –ø—Ä–æ–º–ø—Ç–∞–º–∏**

### –°–∫—Ä–∏–ø—Ç—ã:
- `scripts/defaultPrompts.json` - **–ø—Ä–æ–º–ø—Ç—ã –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –≤ –ë–î**
- `scripts/loadDefaultPrompts.js` - **—Å–∫—Ä–∏–ø—Ç –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–æ–º–ø—Ç–æ–≤**

### –ú–æ–¥–µ–ª–∏:
- `server/models/prompt.js` - **–º–æ–¥–µ–ª—å –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–æ–º–ø—Ç–æ–≤ –≤ MongoDB**

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:

1. **–ó–∞–≥—Ä—É–∑–∏—Ç—å –ø—Ä–æ–º–ø—Ç—ã –≤ –ë–î:**
   ```bash
   npm run load-prompts
   # –∏–ª–∏
   node scripts/loadDefaultPrompts.js
   ```

2. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É:**
   - –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–µ—Ä
   - –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å

3. **–í production:**
   - –ü—Ä–æ–º–ø—Ç—ã –±—É–¥—É—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å—Å—è —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
   - –ú–æ–∂–Ω–æ –º–µ–Ω—è—Ç—å –ø—Ä–æ–º–ø—Ç—ã "–Ω–∞ –ª–µ—Ç—É" –±–µ–∑ –¥–µ–ø–ª–æ—è
   - Fallback —Å–∏—Å—Ç–µ–º–∞ –æ–±–µ—Å–ø–µ—á–∏—Ç –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã:

‚úÖ **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ** - –ø—Ä–æ–º–ø—Ç—ã –º–æ–∂–Ω–æ –º–µ–Ω—è—Ç—å –±–µ–∑ –¥–µ–ø–ª–æ—è  
‚úÖ **–ú—É–ª—å—Ç–∏—è–∑—ã—á–Ω–æ—Å—Ç—å** - —É–¥–æ–±–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–º–ø—Ç–∞–º–∏ –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —è–∑—ã–∫–∞—Ö  
‚úÖ **–ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ** - –≤—ã—Å–æ–∫–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å  
‚úÖ **Fallback —Å–∏—Å—Ç–µ–º–∞** - –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö —Å –ë–î  
‚úÖ **–í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ** - –∏—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –ø—Ä–æ–º–ø—Ç–æ–≤  
‚úÖ **A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** - –º–æ–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–∑–Ω—ã–µ –ø—Ä–æ–º–ø—Ç—ã  

---

üéâ **–ú–ò–ì–†–ê–¶–ò–Ø –ü–†–û–ú–ü–¢–û–í –ü–û–õ–ù–û–°–¢–¨–Æ –ó–ê–í–ï–†–®–ï–ù–ê!**

–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ —Ä–∞–±–æ—Ç–µ –∏ –º–æ–∂–µ—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å—Å—è —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å.
